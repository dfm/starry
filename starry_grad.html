

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>starry.grad &mdash; starry 0.0.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="starry 0.0.2 documentation" href="index.html"/>
        <link rel="up" title="The starry API" href="api.html"/>
        <link rel="prev" title="starry" href="starry.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> starry
          

          
          </a>

          
            
            
              <div class="version">
                0.0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Examples &amp; tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="starry.html">starry</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">starry.grad</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-map-classes">The Map classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-orbital-classes">The orbital classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry/issues">Submit an issue</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/rodluger/starry/raw/master-pdf/tex/starry.pdf">Read the paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">starry</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">starry</a> &raquo;</li>
      
        <li><a href="api.html">The starry API</a>&raquo;</li>
      
    
      <li>starry.grad</li>
    
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<span class="target" id="module-starry.grad"></span><div class="section" id="starry-grad">
<h1>starry.grad<a class="headerlink" href="#starry-grad" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#introduction" id="id1">Introduction</a></li>
<li><a class="reference internal" href="#the-map-classes" id="id2">The Map classes</a></li>
<li><a class="reference internal" href="#the-orbital-classes" id="id3">The orbital classes</a></li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id1">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>This page documents the <a class="reference internal" href="#module-starry.grad" title="starry.grad"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry.grad</span></code></a> API, which is coded
in C++ with a <code class="xref py py-mod docutils literal notranslate"><span class="pre">pybind11</span></code> Python interface. This API is
identical in nearly all respects to the <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a> API, except
that its methods compute gradients with respect to the input parameters,
in addition to the actual return values. For instance, consider the
following code block:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">starry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">starry</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">flux</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">xo</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">yo</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">0.8723336063428014</span>
</pre></div>
</div>
<p>Here’s the same code executed using the <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map()</span></code></a> class in <a class="reference internal" href="#module-starry.grad" title="starry.grad"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry.grad</span></code></a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">starry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">starry</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">flux</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">xo</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">yo</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">0.8723336063428014</span>
</pre></div>
</div>
<p>So far, they look identical. However, in the second case <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code></a>
has also computed the gradient of the flux with respect to each of the
input parameters (including the map coefficients):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">gradient</span>
<span class="go">{&#39;Y_{0,0}&#39;: array([0.]),</span>
<span class="go"> &#39;Y_{1,-1}&#39;: array([-0.00153499]),</span>
<span class="go"> &#39;Y_{1,0}&#39;: array([0.87233361]),</span>
<span class="go"> &#39;Y_{1,1}&#39;: array([-0.5054145]),</span>
<span class="go"> &#39;Y_{2,-1}&#39;: array([0.]),</span>
<span class="go"> &#39;Y_{2,-2}&#39;: array([0.]),</span>
<span class="go"> &#39;Y_{2,0}&#39;: array([0.]),</span>
<span class="go"> &#39;Y_{2,1}&#39;: array([0.]),</span>
<span class="go"> &#39;Y_{2,2}&#39;: array([0.]),</span>
<span class="go"> &#39;axis_x&#39;: array([0.0007675]),</span>
<span class="go"> &#39;axis_y&#39;: array([8.52090655e-20]),</span>
<span class="go"> &#39;axis_z&#39;: array([-0.00020565]),</span>
<span class="go"> &#39;ro&#39;: array([-0.27718567]),</span>
<span class="go"> &#39;theta&#39;: array([-0.00882115]),</span>
<span class="go"> &#39;xo&#39;: array([-0.0063251]),</span>
<span class="go"> &#39;yo&#39;: array([0.00134985])}</span>
</pre></div>
</div>
<p>The <code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient</span></code> attribute can be accessed like any Python
dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">gradient</span><span class="p">[</span><span class="s2">&quot;ro&quot;</span><span class="p">]</span>
<span class="go">array([-0.27718567])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">gradient</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span>
<span class="go">array([-0.00882115])</span>
</pre></div>
</div>
<p>In case <code class="xref py py-obj docutils literal notranslate"><span class="pre">flux</span></code> is called with vector arguments, <code class="xref py py-attr docutils literal notranslate"><span class="pre">gradient</span></code>
is also vectorized:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">starry</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">starry</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">flux</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">theta</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">xo</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="n">yo</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">ro</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="go">array([[0.87233361],</span>
<span class="go">       [0.87177019],</span>
<span class="go">       [0.87135028],</span>
<span class="go">       [0.87108642]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">gradient</span><span class="p">[</span><span class="s2">&quot;ro&quot;</span><span class="p">]</span>
<span class="go">array([-0.27718567, -0.28843198, -0.29678989, -0.30200085])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">gradient</span><span class="p">[</span><span class="s2">&quot;theta&quot;</span><span class="p">]</span>
<span class="go">array([-0.00882115, -0.0088464 , -0.00887311, -0.00890139])</span>
</pre></div>
</div>
<p>Note, importantly, that the derivatives in this module are all
computed <strong>analytically</strong> using autodifferentiation, so their evaluation is fast
and numerically stable. However, runtimes will in general be slower than those
in <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If the degree of the map is large, you may run into a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RuntimeError</span></code></a> saying too many derivatives were requested. The <code class="xref py py-obj docutils literal notranslate"><span class="pre">STARRY_NGRAD</span></code> compiler flag determines the size of the gradient vector and can be changed by setting an environment variable of the same name prior to compiling <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code></a>.
See <a class="reference internal" href="install.html"><span class="doc">Installation</span></a> for more information.</p>
</div>
<p>As in <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a>, the API consists of a <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">Map</span></code></a> class,
which houses all of the surface map photometry
stuff, and the <a class="reference internal" href="#starry.grad.Star" title="starry.grad.Star"><code class="xref py py-class docutils literal notranslate"><span class="pre">Star</span></code></a>, <a class="reference internal" href="#starry.grad.Planet" title="starry.grad.Planet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Planet</span></code></a>, and <a class="reference internal" href="#starry.grad.System" title="starry.grad.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a>
classes, which facilitate the generation of light curves for actual
stellar and planetary systems. There are two broad ways in which users can access
the core <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a> functionality:</p>
<blockquote>
<div><ul class="simple">
<li>Users can instantiate a <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">Map</span></code></a> class to compute phase curves
and occultation light curves by directly specifying the rotational state
of the object and (optionally) the position and size of an occultor.
Users can also instantiate a <a class="reference internal" href="#starry.grad.LimbDarkenedMap" title="starry.grad.LimbDarkenedMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbDarkenedMap</span></code></a> class for
radially-symmetric stellar surfaces. Both cases
may be particularly useful for users who wish to integrate <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a>
with their own dynamical code or for users wishing to compute simple light
curves without any orbital solutions.</li>
<li>Users can instantiate a <a class="reference internal" href="#starry.grad.Star" title="starry.grad.Star"><code class="xref py py-class docutils literal notranslate"><span class="pre">Star</span></code></a> and one or more <a class="reference internal" href="#starry.grad.Planet" title="starry.grad.Planet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Planet</span></code></a>
objects and feed them into a <a class="reference internal" href="#starry.grad.System" title="starry.grad.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> instance for integration
with the Keplerian solver. All <a class="reference internal" href="#starry.grad.Star" title="starry.grad.Star"><code class="xref py py-class docutils literal notranslate"><span class="pre">Star</span></code></a> and <a class="reference internal" href="#starry.grad.Planet" title="starry.grad.Planet"><code class="xref py py-class docutils literal notranslate"><span class="pre">Planet</span></code></a>
instances have a <code class="xref py py-obj docutils literal notranslate"><span class="pre">map</span></code> attribute that allows users to customize
the surface map prior to computing the system light curve.</li>
</ul>
</div></blockquote>
<p>At present, <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a> uses a simple Keplerian solver to compute orbits, so
the second approach listed above is limited to systems with low mass planets that
do not exhibit transit timing variations. The next version will include integration
with an N-body solver, so stay tuned!</p>
</div>
<div class="section" id="the-map-classes">
<h2><a class="toc-backref" href="#id2">The Map classes</a><a class="headerlink" href="#the-map-classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="starry.grad.Map">
<em class="property">class </em><code class="descclassname">starry.grad.</code><code class="descname">Map</code><span class="sig-paren">(</span><em>lmax=2</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a> surface map. Maps instantiated in this fashion
are <em>orthonormalized</em>, so the total integrated luminosity of the map is
<span class="math notranslate nohighlight">\(2\sqrt{\pi} Y_{0,0}\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Largest spherical harmonic degree in the surface map. Default 2.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="starry.grad.Map.optimize">
<code class="descname">optimize</code><a class="headerlink" href="#starry.grad.Map.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> to disable Taylor expansions of the primitive integrals when computing occultation light curves. This is in general not something you should do! Default <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>axis=(0</em>, <em>1</em>, <em>0)</em>, <em>theta=0</em>, <em>x=0</em>, <em>y=0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the specific intensity at a point (<cite>x</cite>, <cite>y</cite>) on the map.</p>
<p>Users may optionally provide a rotation state. Note that this does
not rotate the base map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>axis</strong> (<em>ndarray</em>) – <em>Normalized</em> unit vector specifying the body’s axis of rotation. Default <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>.</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – Angle of rotation in degrees. Default 0.</li>
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – Position scalar, vector, or matrix.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – Position scalar, vector, or matrix.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The specific intensity at (<cite>x</cite>, <cite>y</cite>).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.rotate">
<code class="descname">rotate</code><span class="sig-paren">(</span><em>axis=(0</em>, <em>1</em>, <em>0)</em>, <em>theta=0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate the base map an angle <code class="xref py py-obj docutils literal notranslate"><span class="pre">theta</span></code> about <code class="xref py py-obj docutils literal notranslate"><span class="pre">axis</span></code>.</p>
<p>This performs a permanent rotation to the base map. Subsequent
rotations and calculations will be performed relative to this
rotational state.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>axis</strong> (<em>ndarray</em>) – <em>Normalized</em> unit vector specifying the body’s axis of rotation. Default <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>.</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – Angle of rotation in degrees. Default 0.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.flux">
<code class="descname">flux</code><span class="sig-paren">(</span><em>axis=(0</em>, <em>1</em>, <em>0)</em>, <em>theta=0</em>, <em>xo=0</em>, <em>yo=0</em>, <em>ro=0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total flux received by the observer.</p>
<p>Computes the total flux received by the observer from the
map during or outside of an occultation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>axis</strong> (<em>ndarray</em>) – <em>Normalized</em> unit vector specifying the body’s axis of rotation. Default <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>.</li>
<li><strong>theta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – Angle of rotation. Default 0.</li>
<li><strong>xo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – The <cite>x</cite> position of the occultor (if any). Default 0.</li>
<li><strong>yo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – The <cite>y</cite> position of the occultor (if any). Default 0.</li>
<li><strong>ro</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The radius of the occultor in units of this body’s radius. Default 0 (no occultation).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The flux received by the observer (a scalar or a vector).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.get_coeff">
<code class="descname">get_coeff</code><span class="sig-paren">(</span><em>l</em>, <em>m</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.get_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the (<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">m</span></code>) coefficient of the map.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Users can also retrieve a coefficient by accessing the [<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">m</span></code>] index of the map as if it were a 2D array.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The spherical harmonic degree, ranging from 0 to <a class="reference internal" href="#starry.grad.Map.lmax" title="starry.grad.Map.lmax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lmax</span></code></a>.</li>
<li><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The spherical harmonic order, ranging from -<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code> to <code class="xref py py-attr docutils literal notranslate"><span class="pre">l</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.set_coeff">
<code class="descname">set_coeff</code><span class="sig-paren">(</span><em>l</em>, <em>m</em>, <em>coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.set_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the (<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">m</span></code>) coefficient of the map.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Users can also set a coefficient by setting the [<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">m</span></code>] index of the map as if it were a 2D array.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The spherical harmonic degree, ranging from 0 to <a class="reference internal" href="#starry.grad.Map.lmax" title="starry.grad.Map.lmax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lmax</span></code></a>.</li>
<li><strong>m</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The spherical harmonic order, ranging from -<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code> to <code class="xref py py-attr docutils literal notranslate"><span class="pre">l</span></code>.</li>
<li><strong>coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The value of the coefficient.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all of the map coefficients to zero.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.gradient">
<code class="descname">gradient</code><a class="headerlink" href="#starry.grad.Map.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of derivatives for all model parameters, populated on
calls to <a class="reference internal" href="#starry.grad.Map.flux" title="starry.grad.Map.flux"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flux()</span></code></a> and <a class="reference internal" href="#starry.grad.Map.evaluate" title="starry.grad.Map.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.lmax">
<code class="descname">lmax</code><a class="headerlink" href="#starry.grad.Map.lmax" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest spherical harmonic order of the map. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.y">
<code class="descname">y</code><a class="headerlink" href="#starry.grad.Map.y" title="Permalink to this definition">¶</a></dt>
<dd><p>The spherical harmonic map vector. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.p">
<code class="descname">p</code><a class="headerlink" href="#starry.grad.Map.p" title="Permalink to this definition">¶</a></dt>
<dd><p>The polynomial map vector. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.g">
<code class="descname">g</code><a class="headerlink" href="#starry.grad.Map.g" title="Permalink to this definition">¶</a></dt>
<dd><p>The Green’s polynomial map vector. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.s">
<code class="descname">s</code><a class="headerlink" href="#starry.grad.Map.s" title="Permalink to this definition">¶</a></dt>
<dd><p>The current solution vector <cite>s</cite>. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.r">
<code class="descname">r</code><a class="headerlink" href="#starry.grad.Map.r" title="Permalink to this definition">¶</a></dt>
<dd><p>The current solution vector <cite>r</cite>. <em>Read-only.</em></p>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.minimum">
<code class="descname">minimum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.minimum" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the global minimum of the map.</p>
<p>This routine wraps <code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.optimize.minimize</span></code> to find
the global minimum of the surface map. This is useful for ensuring
that the surface map is nonnegative everywhere.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Because this routine wraps a Python wrapper of a C function to perform a non-linear optimization in three dimensions, it is <strong>slow</strong> and should probably not be used repeatedly when fitting a map to data!</p>
</div>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.load_array">
<code class="descname">load_array</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.load_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a lat-lon image array.</p>
<p>This routine loads a 2D <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code> array, computes its
spherical harmonic expansion up to degree <a class="reference internal" href="#starry.grad.Map.lmax" title="starry.grad.Map.lmax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lmax</span></code></a>,
and sets the map vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<em>ndarray</em>) – The 2D <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy</span></code> lat-lon array.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.load_image">
<code class="descname">load_image</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.load_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an image from file.</p>
<p>This routine loads an image file, computes its spherical harmonic
expansion up to degree <a class="reference internal" href="#starry.grad.Map.lmax" title="starry.grad.Map.lmax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lmax</span></code></a>, and sets the map vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – The full path to the image file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.load_healpix">
<code class="descname">load_healpix</code><span class="sig-paren">(</span><em>image</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.load_healpix" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a healpix image array.</p>
<p>This routine loads a <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> array, computes its
spherical harmonic
expansion up to degree <a class="reference internal" href="#starry.grad.Map.lmax" title="starry.grad.Map.lmax"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lmax</span></code></a>, and sets the map vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>image</strong> (<em>ndarray</em>) – The ring-ordered <code class="xref py py-obj docutils literal notranslate"><span class="pre">healpix</span></code> array.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>cmap='plasma'</em>, <em>res=300</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience routine to quickly display the body’s surface map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – The <code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code> colormap name. Default <cite>plasma</cite>.</li>
<li><strong>res</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The resolution of the map in pixels on a side. Default 300.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.Map.animate">
<code class="descname">animate</code><span class="sig-paren">(</span><em>axis=(0</em>, <em>1</em>, <em>0)</em>, <em>cmap='plasma'</em>, <em>res=150</em>, <em>frames=50</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Map.animate" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience routine to animate the body’s surface map as it rotates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>axis</strong> (<em>ndarray</em>) – <em>Normalized</em> unit vector specifying the axis of rotation. Default <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>.</li>
<li><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – The <code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code> colormap name. Default <cite>plasma</cite>.</li>
<li><strong>res</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The resolution of the map in pixels on a side. Default 150.</li>
<li><strong>frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The number of frames in the animation. Default 50.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.mp_digits">
<code class="descname">mp_digits</code><a class="headerlink" href="#starry.grad.Map.mp_digits" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of digits used to perform multi-precision calculations.
Double precision roughly corresponds to 16, and quadruple
precision (default) roughly corresponds 32.
This is a compile-time constant. If you wish to change it, you’ll
have to re-compile <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code></a>. See <a class="reference internal" href="install.html"><span class="doc">Installation</span></a> for more information.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Map.ngrad">
<code class="descname">ngrad</code><a class="headerlink" href="#starry.grad.Map.ngrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Length of the gradient vector.
This is a compile-time constant. If you get errors saying this
value is too small, you’ll need to re-compile <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code></a>.
See <a class="reference internal" href="install.html"><span class="doc">Installation</span></a> for more information.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="starry.grad.LimbDarkenedMap">
<em class="property">class </em><code class="descclassname">starry.grad.</code><code class="descname">LimbDarkenedMap</code><span class="sig-paren">(</span><em>lmax=2</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a> limb-darkened surface map.</p>
<p>This differs from the base <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">Map</span></code></a> class in that maps
instantiated this way are radially symmetric: only the radial (<code class="xref py py-obj docutils literal notranslate"><span class="pre">m</span> <span class="pre">=</span> <span class="pre">0</span></code>)
coefficients of the map are available. Users edit the map by directly
specifying the polynomial limb darkening coefficients <a class="reference internal" href="#starry.grad.LimbDarkenedMap.u" title="starry.grad.LimbDarkenedMap.u"><code class="xref py py-obj docutils literal notranslate"><span class="pre">u</span></code></a>, starting
with <span class="math notranslate nohighlight">\(u_1\)</span> (linear limb darkening). The coefficient <span class="math notranslate nohighlight">\(u_0\)</span> is fixed to enforce
the correct normalization.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Unlike <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-class docutils literal notranslate"><span class="pre">Map</span></code></a>, maps instantiated this way are normalized so that the integral of the specific intensity over the visible disk is unity. This is convenient for using this map to model stars: the unocculted flux from the star is equal to one, regardless of the limb-darkening coefficients!</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Largest spherical harmonic degree in the surface map. Default 2.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.optimize">
<code class="descname">optimize</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> to disable Taylor expansions of the primitive integrals when computing occultation light curves. This is in general not something you should do! Default <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.6)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="starry.grad.LimbDarkenedMap.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>x=0</em>, <em>y=0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the specific intensity at a point (<cite>x</cite>, <cite>y</cite>) on the map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – Position scalar, vector, or matrix.</li>
<li><strong>y</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – Position scalar, vector, or matrix.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The specific intensity at (<cite>x</cite>, <cite>y</cite>).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.LimbDarkenedMap.flux">
<code class="descname">flux</code><span class="sig-paren">(</span><em>xo=0</em>, <em>yo=0</em>, <em>ro=0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total flux received by the observer.</p>
<p>Computes the total flux received by the observer from the
map during or outside of an occultation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – The <cite>x</cite> position of the occultor (if any). Default 0.</li>
<li><strong>yo</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a><em> or </em><em>ndarray</em>) – The <cite>y</cite> position of the occultor (if any). Default 0.</li>
<li><strong>ro</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The radius of the occultor in units of this body’s radius. Default 0 (no occultation).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The flux received by the observer (a scalar or a vector).</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.LimbDarkenedMap.get_coeff">
<code class="descname">get_coeff</code><span class="sig-paren">(</span><em>l</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap.get_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the limb darkening coefficient of order <code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Users can also retrieve a coefficient by accessing the [<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>] index of the map as if it were an array.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The limb darkening order (&gt; 0).</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.LimbDarkenedMap.set_coeff">
<code class="descname">set_coeff</code><span class="sig-paren">(</span><em>l</em>, <em>coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap.set_coeff" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the limb darkening coefficient of order <code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Users can also set a coefficient by setting the [<code class="xref py py-obj docutils literal notranslate"><span class="pre">l</span></code>] index of the map as if it were an array.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The limb darkening order (&gt; 0).</li>
<li><strong>coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The value of the coefficient.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="starry.grad.LimbDarkenedMap.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Set all of the map coefficients to zero.</p>
</dd></dl>

<dl class="method">
<dt id="starry.grad.LimbDarkenedMap.roots">
<code class="descname">roots</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap.roots" title="Permalink to this definition">¶</a></dt>
<dd><p>Count the number of roots of the specific intensity using Sturm’s
theorem. Physical maps with positive semi-definite specific
intensity should have zero roots. If this number is nonzero,
your star has negative brightness somewhere!</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.gradient">
<code class="descname">gradient</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of derivatives for all model parameters, populated on
calls to <a class="reference internal" href="#starry.grad.LimbDarkenedMap.flux" title="starry.grad.LimbDarkenedMap.flux"><code class="xref py py-meth docutils literal notranslate"><span class="pre">flux()</span></code></a> and <a class="reference internal" href="#starry.grad.LimbDarkenedMap.evaluate" title="starry.grad.LimbDarkenedMap.evaluate"><code class="xref py py-meth docutils literal notranslate"><span class="pre">evaluate()</span></code></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.lmax">
<code class="descname">lmax</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.lmax" title="Permalink to this definition">¶</a></dt>
<dd><p>The highest spherical harmonic order of the map. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.y">
<code class="descname">y</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.y" title="Permalink to this definition">¶</a></dt>
<dd><p>The spherical harmonic map vector. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.p">
<code class="descname">p</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.p" title="Permalink to this definition">¶</a></dt>
<dd><p>The polynomial map vector. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.g">
<code class="descname">g</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.g" title="Permalink to this definition">¶</a></dt>
<dd><p>The Green’s polynomial map vector. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.u">
<code class="descname">u</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.u" title="Permalink to this definition">¶</a></dt>
<dd><p>The limb darkening coefficient vector. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.s">
<code class="descname">s</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.s" title="Permalink to this definition">¶</a></dt>
<dd><p>The current solution vector <cite>s</cite>. <em>Read-only.</em></p>
</dd></dl>

<dl class="method">
<dt id="starry.grad.LimbDarkenedMap.show">
<code class="descname">show</code><span class="sig-paren">(</span><em>cmap='plasma'</em>, <em>res=300</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.LimbDarkenedMap.show" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience routine to quickly display the body’s surface map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>cmap</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – The <code class="xref py py-mod docutils literal notranslate"><span class="pre">matplotlib</span></code> colormap name. Default <cite>plasma</cite>.</li>
<li><strong>res</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – The resolution of the map in pixels on a side. Default 300.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.mp_digits">
<code class="descname">mp_digits</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.mp_digits" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of digits used to perform multi-precision calculations.
Double precision roughly corresponds to 16, and quadruple
precision (default) roughly corresponds 32.
This is a compile-time constant. If you wish to change it, you’ll
have to re-compile <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code></a>. See <a class="reference internal" href="install.html"><span class="doc">Installation</span></a> for more information.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.LimbDarkenedMap.ngrad">
<code class="descname">ngrad</code><a class="headerlink" href="#starry.grad.LimbDarkenedMap.ngrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Length of the gradient vector.
This is a compile-time constant. If you get errors saying this
value is too small, you’ll need to re-compile <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-obj docutils literal notranslate"><span class="pre">starry</span></code></a>.
See <a class="reference internal" href="install.html"><span class="doc">Installation</span></a> for more information.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-orbital-classes">
<h2><a class="toc-backref" href="#id3">The orbital classes</a><a class="headerlink" href="#the-orbital-classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="starry.grad.Star">
<em class="property">class </em><code class="descclassname">starry.grad.</code><code class="descname">Star</code><a class="headerlink" href="#starry.grad.Star" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a stellar <code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code> object.</p>
<p>The star’s radius and luminosity are fixed at unity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Largest spherical harmonic degree in body’s surface map. Default 2.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="starry.grad.Star.map">
<code class="descname">map</code><a class="headerlink" href="#starry.grad.Star.map" title="Permalink to this definition">¶</a></dt>
<dd><p>The star’s surface map, a <a class="reference internal" href="#starry.grad.LimbDarkenedMap" title="starry.grad.LimbDarkenedMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">LimbDarkenedMap</span></code></a> instance.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Star.flux">
<code class="descname">flux</code><a class="headerlink" href="#starry.grad.Star.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>The body’s computed light curve. <em>Read-only</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Star.gradient">
<code class="descname">gradient</code><a class="headerlink" href="#starry.grad.Star.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of derivatives of the body’s flux with respect to
all model parameters, populated on calls to <a class="reference internal" href="#starry.grad.System.compute" title="starry.grad.System.compute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">System.compute()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This dictionary is similar to the <a class="reference internal" href="#starry.grad.Star.gradient" title="starry.grad.Star.gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient</span></code></a> attribute of a <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a> instance, but the keys in the dictionary are prepended by either <cite>star.</cite> (for the star) or <cite>planetX</cite> (where <cite>X</cite> is the planet number,
starting with 1). For instance, the gradient of this body’s flux with respect to the second planet’s eccentricity is <code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient['planet2.ecc']</span></code>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Star.r">
<code class="descname">r</code><a class="headerlink" href="#starry.grad.Star.r" title="Permalink to this definition">¶</a></dt>
<dd><p>The star’s radius, fixed to unity. <em>Read-only.</em></p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Star.L">
<code class="descname">L</code><a class="headerlink" href="#starry.grad.Star.L" title="Permalink to this definition">¶</a></dt>
<dd><p>The star’s luminosity, fixed to unity. <em>Read-only.</em></p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="starry.grad.Planet">
<em class="property">class </em><code class="descclassname">starry.grad.</code><code class="descname">Planet</code><span class="sig-paren">(</span><em>lmax=2</em>, <em>r=0.1</em>, <em>L=0</em>, <em>axis=(0</em>, <em>1</em>, <em>0)</em>, <em>prot=0</em>, <em>a=50</em>, <em>porb=1</em>, <em>inc=90</em>, <em>ecc=0</em>, <em>w=90</em>, <em>Omega=0</em>, <em>lambda0=90</em>, <em>tref=0</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.Planet" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a planetary <code class="xref py py-class docutils literal notranslate"><span class="pre">Body</span></code> object.</p>
<p>Instantiate a planet. At present, <a class="reference internal" href="starry.html#module-starry" title="starry"><code class="xref py py-mod docutils literal notranslate"><span class="pre">starry</span></code></a> computes orbits with a simple
Keplerian solver, so the planet is assumed to be massless.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Largest spherical harmonic degree in body’s surface map. Default 2.</li>
<li><strong>r</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Body radius in stellar radii. Default 0.1</li>
<li><strong>L</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Body luminosity in units of the stellar luminosity. Default 0.</li>
<li><strong>axis</strong> (<em>ndarray</em>) – A <em>normalized</em> unit vector specifying the body’s axis of rotation. Default <span class="math notranslate nohighlight">\(\hat{y} = (0, 1, 0)\)</span>.</li>
<li><strong>prot</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Rotation period in days. Default no rotation.</li>
<li><strong>a</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Semi-major axis in stellar radii. Default 50.</li>
<li><strong>porb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Orbital period in days. Default 1.</li>
<li><strong>inc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Orbital inclination in degrees. Default 90.</li>
<li><strong>ecc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Orbital eccentricity. Default 0.</li>
<li><strong>w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Longitude of pericenter in degrees. Default 90.</li>
<li><strong>Omega</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Longitude of ascending node in degrees. Default 0.</li>
<li><strong>lambda0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Mean longitude at time <a class="reference internal" href="#starry.grad.Planet.tref" title="starry.grad.Planet.tref"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tref</span></code></a> in degrees. Default 90.</li>
<li><strong>tref</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Reference time in days. Default 0.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="starry.grad.Planet.map">
<code class="descname">map</code><a class="headerlink" href="#starry.grad.Planet.map" title="Permalink to this definition">¶</a></dt>
<dd><p>The body’s surface map.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.flux">
<code class="descname">flux</code><a class="headerlink" href="#starry.grad.Planet.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>The body’s computed light curve. <em>Read-only</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.gradient">
<code class="descname">gradient</code><a class="headerlink" href="#starry.grad.Planet.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of derivatives of the body’s flux with respect to
all model parameters, populated on calls to <a class="reference internal" href="#starry.grad.System.compute" title="starry.grad.System.compute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">System.compute()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This dictionary is similar to the <a class="reference internal" href="#starry.grad.Planet.gradient" title="starry.grad.Planet.gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient</span></code></a> attribute of a <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a> instance, but the keys in the dictionary are prepended by either <cite>star.</cite> (for the star) or <cite>planetX</cite> (where <cite>X</cite> is the planet number,
starting with 1). For instance, the gradient of this body’s flux with respect to the second planet’s eccentricity is <code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient['planet2.ecc']</span></code>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.x">
<code class="descname">x</code><a class="headerlink" href="#starry.grad.Planet.x" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>x</cite> position of the body in stellar radii. <em>Read-only</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.y">
<code class="descname">y</code><a class="headerlink" href="#starry.grad.Planet.y" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>y</cite> position of the body in stellar radii. <em>Read-only</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.z">
<code class="descname">z</code><a class="headerlink" href="#starry.grad.Planet.z" title="Permalink to this definition">¶</a></dt>
<dd><p>The <cite>z</cite> position of the body in stellar radii. <em>Read-only</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.r">
<code class="descname">r</code><a class="headerlink" href="#starry.grad.Planet.r" title="Permalink to this definition">¶</a></dt>
<dd><p>Body radius in units of stellar radius.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.L">
<code class="descname">L</code><a class="headerlink" href="#starry.grad.Planet.L" title="Permalink to this definition">¶</a></dt>
<dd><p>Body luminosity in units of stellar luminosity.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.axis">
<code class="descname">axis</code><a class="headerlink" href="#starry.grad.Planet.axis" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Normalized</em> unit vector specifying the body’s axis of rotation.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.prot">
<code class="descname">prot</code><a class="headerlink" href="#starry.grad.Planet.prot" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotation period in days.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.a">
<code class="descname">a</code><a class="headerlink" href="#starry.grad.Planet.a" title="Permalink to this definition">¶</a></dt>
<dd><p>Body semi-major axis in units of stellar radius.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.porb">
<code class="descname">porb</code><a class="headerlink" href="#starry.grad.Planet.porb" title="Permalink to this definition">¶</a></dt>
<dd><p>Orbital period in days.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.inc">
<code class="descname">inc</code><a class="headerlink" href="#starry.grad.Planet.inc" title="Permalink to this definition">¶</a></dt>
<dd><p>Orbital inclination in degrees.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.ecc">
<code class="descname">ecc</code><a class="headerlink" href="#starry.grad.Planet.ecc" title="Permalink to this definition">¶</a></dt>
<dd><p>Orbital eccentricity.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.w">
<code class="descname">w</code><a class="headerlink" href="#starry.grad.Planet.w" title="Permalink to this definition">¶</a></dt>
<dd><p>Longitude of pericenter in degrees. This is usually denoted <span class="math notranslate nohighlight">\(\varomega\)</span>.
See the <a class="reference external" href="https://en.wikipedia.org/wiki/Longitude_of_the_periapsis">Wikipedia</a> entry.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.Omega">
<code class="descname">Omega</code><a class="headerlink" href="#starry.grad.Planet.Omega" title="Permalink to this definition">¶</a></dt>
<dd><p>Longitude of ascending node in degrees.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.lambda0">
<code class="descname">lambda0</code><a class="headerlink" href="#starry.grad.Planet.lambda0" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean longitude at time <a class="reference internal" href="#starry.grad.Planet.tref" title="starry.grad.Planet.tref"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tref</span></code></a> in degrees.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.Planet.tref">
<code class="descname">tref</code><a class="headerlink" href="#starry.grad.Planet.tref" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference time in days.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="starry.grad.System">
<em class="property">class </em><code class="descclassname">starry.grad.</code><code class="descname">System</code><span class="sig-paren">(</span><em>bodies</em>, <em>kepler_tol=1.0e-7</em>, <em>kepler_max_iter=100</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.System" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate an orbital system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bodies</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a>) – List of bodies in the system, with the primary (usually the star) listed first.</li>
<li><strong>scale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – This parameter sets the lengthscale for computing the light travel time delay and is simply equal to the radius of the star in <span class="math notranslate nohighlight">\(R_\odot\)</span>. Default <cite>0</cite>, meaning the light travel time effect is not computed.</li>
<li><strong>kepler_tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Kepler solver tolerance. Default <cite>1e-7</cite>.</li>
<li><strong>kepler_max_iter</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Maximum number of iterations in the Kepler solver. Default <cite>100</cite>.</li>
<li><strong>exposure_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – The exposure time of the observations in days. If nonzero, the flux will be integrated over this exposure time. Default <cite>0</cite>.</li>
<li><strong>exposure_tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – Tolerance of the recursive method for integrating the flux over the exposure time. Default <cite>1e-8</cite>.</li>
<li><strong>exposure_maxdepth</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Maximum recursion depth for the exposure calculation. Default <cite>4</cite>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="starry.grad.System.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#starry.grad.System.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the system light curve analytically.</p>
<p>Compute the full system light curve at the times
given by the <code class="xref py py-obj docutils literal notranslate"><span class="pre">time</span></code> array and store the result
in <a class="reference internal" href="#starry.grad.System.flux" title="starry.grad.System.flux"><code class="xref py py-attr docutils literal notranslate"><span class="pre">flux</span></code></a>. The light curve for each body in the
system is stored in the body’s <a class="reference internal" href="#starry.grad.System.flux" title="starry.grad.System.flux"><code class="xref py py-attr docutils literal notranslate"><span class="pre">flux</span></code></a> attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong> (<em>ndarray</em>) – Time array, measured in days.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.flux">
<code class="descname">flux</code><a class="headerlink" href="#starry.grad.System.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>The computed system light curve. Must run <a class="reference internal" href="#starry.grad.System.compute" title="starry.grad.System.compute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute()</span></code></a> first. <em>Read-only</em>.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.gradient">
<code class="descname">gradient</code><a class="headerlink" href="#starry.grad.System.gradient" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary of derivatives of the system flux with respect to
all model parameters, populated on calls to <a class="reference internal" href="#starry.grad.System.compute" title="starry.grad.System.compute"><code class="xref py py-meth docutils literal notranslate"><span class="pre">compute()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This dictionary is similar to the <a class="reference internal" href="#starry.grad.System.gradient" title="starry.grad.System.gradient"><code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient</span></code></a> attribute of a <a class="reference internal" href="#starry.grad.Map" title="starry.grad.Map"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Map</span></code></a> instance, but the keys in the dictionary are prepended by either <cite>star.</cite> (for the star) or <cite>planetX</cite> (where <cite>X</cite> is the planet number,
starting with 1). For instance, the gradient of the system flux with respect to the second planet’s eccentricity is <code class="xref py py-obj docutils literal notranslate"><span class="pre">gradient['planet2.ecc']</span></code>.</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.scale">
<code class="descname">scale</code><a class="headerlink" href="#starry.grad.System.scale" title="Permalink to this definition">¶</a></dt>
<dd><p>This parameter sets the lengthscale for computing the light travel time delay
and is simply equal to the radius of the star in <span class="math notranslate nohighlight">\(R_\odot\)</span>. If zero, the light
travel time delay is not computed, corresponding to an effectively infinite
speed of light.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.exposure_time">
<code class="descname">exposure_time</code><a class="headerlink" href="#starry.grad.System.exposure_time" title="Permalink to this definition">¶</a></dt>
<dd><p>The exposure time of the observations in days. If nonzero, the flux will
be integrated over this exposure time.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.exposure_tol">
<code class="descname">exposure_tol</code><a class="headerlink" href="#starry.grad.System.exposure_tol" title="Permalink to this definition">¶</a></dt>
<dd><p>Tolerance of the recursive method for integrating the flux over the exposure time.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.exposure_max_depth">
<code class="descname">exposure_max_depth</code><a class="headerlink" href="#starry.grad.System.exposure_max_depth" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum recursion depth for the exposure calculation.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.kepler_tol">
<code class="descname">kepler_tol</code><a class="headerlink" href="#starry.grad.System.kepler_tol" title="Permalink to this definition">¶</a></dt>
<dd><p>Kepler solver tolerance.</p>
</dd></dl>

<dl class="attribute">
<dt id="starry.grad.System.kepler_max_iter">
<code class="descname">kepler_max_iter</code><a class="headerlink" href="#starry.grad.System.kepler_max_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum number of iterations in the Kepler solver.</p>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="starry.html" class="btn btn-neutral" title="starry" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Rodrigo Luger.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>